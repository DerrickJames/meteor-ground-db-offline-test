[{"type":"js","data":"(function () {\n\n/* Imports */\nvar Meteor = Package.meteor.Meteor;\nvar _ = Package.underscore._;\nvar SpacebarsCompiler = Package['spacebars-compiler'].SpacebarsCompiler;\nvar Spacebars = Package.spacebars.Spacebars;\nvar HTML = Package.htmljs.HTML;\nvar Blaze = Package.blaze.Blaze;\nvar UI = Package.blaze.UI;\nvar Handlebars = Package.blaze.Handlebars;\n\n/* Package-scope variables */\nvar Boilerplate;\n\n(function(){\n\n//////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                      //\n// packages/boilerplate-generator/packages/boilerplate-generator.js                     //\n//                                                                                      //\n//////////////////////////////////////////////////////////////////////////////////////////\n                                                                                        //\n(function(){                                                                            // 1\n                                                                                        // 2\n///////////////////////////////////////////////////////////////////////////////////     // 3\n//                                                                               //     // 4\n// packages/boilerplate-generator/boilerplate-generator.js                       //     // 5\n//                                                                               //     // 6\n///////////////////////////////////////////////////////////////////////////////////     // 7\n                                                                                 //     // 8\nvar fs = Npm.require('fs');                                                      // 1   // 9\nvar path = Npm.require('path');                                                  // 2   // 10\n                                                                                 // 3   // 11\n// Copied from webapp_server                                                     // 4   // 12\nvar readUtf8FileSync = function (filename) {                                     // 5   // 13\n  return Meteor.wrapAsync(fs.readFile)(filename, 'utf8');                        // 6   // 14\n};                                                                               // 7   // 15\n                                                                                 // 8   // 16\nBoilerplate = function (arch, manifest, options) {                               // 9   // 17\n  var self = this;                                                               // 10  // 18\n  options = options || {};                                                       // 11  // 19\n  self.template = _getTemplate(arch);                                            // 12  // 20\n  self.baseData = null;                                                          // 13  // 21\n  self.func = null;                                                              // 14  // 22\n                                                                                 // 15  // 23\n  self._generateBoilerplateFromManifestAndSource(                                // 16  // 24\n    manifest,                                                                    // 17  // 25\n    self.template,                                                               // 18  // 26\n    options                                                                      // 19  // 27\n  );                                                                             // 20  // 28\n};                                                                               // 21  // 29\n                                                                                 // 22  // 30\n// The 'extraData' argument can be used to extend 'self.baseData'. Its           // 23  // 31\n// purpose is to allow you to specify data that you might not know at            // 24  // 32\n// the time that you construct the Boilerplate object. (e.g. it is used          // 25  // 33\n// by 'webapp' to specify data that is only known at request-time).              // 26  // 34\nBoilerplate.prototype.toHTML = function (extraData) {                            // 27  // 35\n  var self = this;                                                               // 28  // 36\n                                                                                 // 29  // 37\n  if (! self.baseData || ! self.func)                                            // 30  // 38\n    throw new Error('Boilerplate did not instantiate correctly.');               // 31  // 39\n                                                                                 // 32  // 40\n  return  \"<!DOCTYPE html>\\n\" +                                                  // 33  // 41\n    Blaze.toHTML(Blaze.With(_.extend(self.baseData, extraData),                  // 34  // 42\n                            self.func));                                         // 35  // 43\n};                                                                               // 36  // 44\n                                                                                 // 37  // 45\n// XXX Exported to allow client-side only changes to rebuild the boilerplate     // 38  // 46\n// without requiring a full server restart.                                      // 39  // 47\n// Produces an HTML string with given manifest and boilerplateSource.            // 40  // 48\n// Optionally takes urlMapper in case urls from manifest need to be prefixed     // 41  // 49\n// or rewritten.                                                                 // 42  // 50\n// Optionally takes pathMapper for resolving relative file system paths.         // 43  // 51\n// Optionally allows to override fields of the data context.                     // 44  // 52\nBoilerplate.prototype._generateBoilerplateFromManifestAndSource =                // 45  // 53\n  function (manifest, boilerplateSource, options) {                              // 46  // 54\n    var self = this;                                                             // 47  // 55\n    // map to the identity by default                                            // 48  // 56\n    var urlMapper = options.urlMapper || _.identity;                             // 49  // 57\n    var pathMapper = options.pathMapper || _.identity;                           // 50  // 58\n                                                                                 // 51  // 59\n    var boilerplateBaseData = {                                                  // 52  // 60\n      css: [],                                                                   // 53  // 61\n      js: [],                                                                    // 54  // 62\n      head: '',                                                                  // 55  // 63\n      body: '',                                                                  // 56  // 64\n      meteorManifest: JSON.stringify(manifest)                                   // 57  // 65\n    };                                                                           // 58  // 66\n                                                                                 // 59  // 67\n    // allow the caller to extend the default base data                          // 60  // 68\n    _.extend(boilerplateBaseData, options.baseDataExtension);                    // 61  // 69\n                                                                                 // 62  // 70\n    _.each(manifest, function (item) {                                           // 63  // 71\n      var urlPath = urlMapper(item.url);                                         // 64  // 72\n      var itemObj = { url: urlPath };                                            // 65  // 73\n                                                                                 // 66  // 74\n      if (options.inline) {                                                      // 67  // 75\n        itemObj.scriptContent = readUtf8FileSync(                                // 68  // 76\n          pathMapper(item.path));                                                // 69  // 77\n        itemObj.inline = true;                                                   // 70  // 78\n      }                                                                          // 71  // 79\n                                                                                 // 72  // 80\n      if (item.type === 'css' && item.where === 'client') {                      // 73  // 81\n        boilerplateBaseData.css.push(itemObj);                                   // 74  // 82\n      }                                                                          // 75  // 83\n      if (item.type === 'js' && item.where === 'client') {                       // 76  // 84\n        boilerplateBaseData.js.push(itemObj);                                    // 77  // 85\n      }                                                                          // 78  // 86\n      if (item.type === 'head') {                                                // 79  // 87\n        boilerplateBaseData.head =                                               // 80  // 88\n          readUtf8FileSync(pathMapper(item.path));                               // 81  // 89\n      }                                                                          // 82  // 90\n      if (item.type === 'body') {                                                // 83  // 91\n        boilerplateBaseData.body =                                               // 84  // 92\n          readUtf8FileSync(pathMapper(item.path));                               // 85  // 93\n      }                                                                          // 86  // 94\n    });                                                                          // 87  // 95\n    var boilerplateRenderCode = SpacebarsCompiler.compile(                       // 88  // 96\n      boilerplateSource, { isBody: true });                                      // 89  // 97\n                                                                                 // 90  // 98\n    // Note that we are actually depending on eval's local environment capture   // 91  // 99\n    // so that UI and HTML are visible to the eval'd code.                       // 92  // 100\n    // XXX the template we are evaluating relies on the fact that UI is globally        // 101\n      // available.                                                              // 94  // 102\n    global.UI = UI;                                                              // 95  // 103\n    self.func = eval(boilerplateRenderCode);                                     // 96  // 104\n    self.baseData = boilerplateBaseData;                                         // 97  // 105\n};                                                                               // 98  // 106\n                                                                                 // 99  // 107\nvar _getTemplate = _.memoize(function (arch) {                                   // 100\n  var filename = 'boilerplate_' + arch + '.html';                                // 101\n  return Assets.getText(filename);                                               // 102\n});                                                                              // 103\n                                                                                 // 104\n///////////////////////////////////////////////////////////////////////////////////     // 113\n                                                                                        // 114\n}).call(this);                                                                          // 115\n                                                                                        // 116\n//////////////////////////////////////////////////////////////////////////////////////////\n\n}).call(this);\n\n\n/* Exports */\nif (typeof Package === 'undefined') Package = {};\nPackage['boilerplate-generator'] = {\n  Boilerplate: Boilerplate\n};\n\n})();\n","servePath":"/packages/boilerplate-generator.js","sourceMap":{"version":3,"sources":["/packages/boilerplate-generator/packages/boilerplate-generator.js"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8F","file":"/packages/boilerplate-generator.js","sourcesContent":["(function(){\n\n///////////////////////////////////////////////////////////////////////////////////\n//                                                                               //\n// packages/boilerplate-generator/boilerplate-generator.js                       //\n//                                                                               //\n///////////////////////////////////////////////////////////////////////////////////\n                                                                                 //\nvar fs = Npm.require('fs');                                                      // 1\nvar path = Npm.require('path');                                                  // 2\n                                                                                 // 3\n// Copied from webapp_server                                                     // 4\nvar readUtf8FileSync = function (filename) {                                     // 5\n  return Meteor.wrapAsync(fs.readFile)(filename, 'utf8');                        // 6\n};                                                                               // 7\n                                                                                 // 8\nBoilerplate = function (arch, manifest, options) {                               // 9\n  var self = this;                                                               // 10\n  options = options || {};                                                       // 11\n  self.template = _getTemplate(arch);                                            // 12\n  self.baseData = null;                                                          // 13\n  self.func = null;                                                              // 14\n                                                                                 // 15\n  self._generateBoilerplateFromManifestAndSource(                                // 16\n    manifest,                                                                    // 17\n    self.template,                                                               // 18\n    options                                                                      // 19\n  );                                                                             // 20\n};                                                                               // 21\n                                                                                 // 22\n// The 'extraData' argument can be used to extend 'self.baseData'. Its           // 23\n// purpose is to allow you to specify data that you might not know at            // 24\n// the time that you construct the Boilerplate object. (e.g. it is used          // 25\n// by 'webapp' to specify data that is only known at request-time).              // 26\nBoilerplate.prototype.toHTML = function (extraData) {                            // 27\n  var self = this;                                                               // 28\n                                                                                 // 29\n  if (! self.baseData || ! self.func)                                            // 30\n    throw new Error('Boilerplate did not instantiate correctly.');               // 31\n                                                                                 // 32\n  return  \"<!DOCTYPE html>\\n\" +                                                  // 33\n    Blaze.toHTML(Blaze.With(_.extend(self.baseData, extraData),                  // 34\n                            self.func));                                         // 35\n};                                                                               // 36\n                                                                                 // 37\n// XXX Exported to allow client-side only changes to rebuild the boilerplate     // 38\n// without requiring a full server restart.                                      // 39\n// Produces an HTML string with given manifest and boilerplateSource.            // 40\n// Optionally takes urlMapper in case urls from manifest need to be prefixed     // 41\n// or rewritten.                                                                 // 42\n// Optionally takes pathMapper for resolving relative file system paths.         // 43\n// Optionally allows to override fields of the data context.                     // 44\nBoilerplate.prototype._generateBoilerplateFromManifestAndSource =                // 45\n  function (manifest, boilerplateSource, options) {                              // 46\n    var self = this;                                                             // 47\n    // map to the identity by default                                            // 48\n    var urlMapper = options.urlMapper || _.identity;                             // 49\n    var pathMapper = options.pathMapper || _.identity;                           // 50\n                                                                                 // 51\n    var boilerplateBaseData = {                                                  // 52\n      css: [],                                                                   // 53\n      js: [],                                                                    // 54\n      head: '',                                                                  // 55\n      body: '',                                                                  // 56\n      meteorManifest: JSON.stringify(manifest)                                   // 57\n    };                                                                           // 58\n                                                                                 // 59\n    // allow the caller to extend the default base data                          // 60\n    _.extend(boilerplateBaseData, options.baseDataExtension);                    // 61\n                                                                                 // 62\n    _.each(manifest, function (item) {                                           // 63\n      var urlPath = urlMapper(item.url);                                         // 64\n      var itemObj = { url: urlPath };                                            // 65\n                                                                                 // 66\n      if (options.inline) {                                                      // 67\n        itemObj.scriptContent = readUtf8FileSync(                                // 68\n          pathMapper(item.path));                                                // 69\n        itemObj.inline = true;                                                   // 70\n      }                                                                          // 71\n                                                                                 // 72\n      if (item.type === 'css' && item.where === 'client') {                      // 73\n        boilerplateBaseData.css.push(itemObj);                                   // 74\n      }                                                                          // 75\n      if (item.type === 'js' && item.where === 'client') {                       // 76\n        boilerplateBaseData.js.push(itemObj);                                    // 77\n      }                                                                          // 78\n      if (item.type === 'head') {                                                // 79\n        boilerplateBaseData.head =                                               // 80\n          readUtf8FileSync(pathMapper(item.path));                               // 81\n      }                                                                          // 82\n      if (item.type === 'body') {                                                // 83\n        boilerplateBaseData.body =                                               // 84\n          readUtf8FileSync(pathMapper(item.path));                               // 85\n      }                                                                          // 86\n    });                                                                          // 87\n    var boilerplateRenderCode = SpacebarsCompiler.compile(                       // 88\n      boilerplateSource, { isBody: true });                                      // 89\n                                                                                 // 90\n    // Note that we are actually depending on eval's local environment capture   // 91\n    // so that UI and HTML are visible to the eval'd code.                       // 92\n    // XXX the template we are evaluating relies on the fact that UI is globally\n      // available.                                                              // 94\n    global.UI = UI;                                                              // 95\n    self.func = eval(boilerplateRenderCode);                                     // 96\n    self.baseData = boilerplateBaseData;                                         // 97\n};                                                                               // 98\n                                                                                 // 99\nvar _getTemplate = _.memoize(function (arch) {                                   // 100\n  var filename = 'boilerplate_' + arch + '.html';                                // 101\n  return Assets.getText(filename);                                               // 102\n});                                                                              // 103\n                                                                                 // 104\n///////////////////////////////////////////////////////////////////////////////////\n\n}).call(this);\n"]}}]