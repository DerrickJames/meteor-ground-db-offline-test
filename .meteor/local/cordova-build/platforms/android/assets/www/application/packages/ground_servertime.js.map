{"version":3,"sources":["meteor://ðŸ’»app/packages/ground_servertime/packages/ground_servertime.js"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4F","file":"/packages/ground_servertime.js","sourcesContent":["(function () {\n\n///////////////////////////////////////////////////////////////////////////////////\n//                                                                               //\n// packages/ground:servertime/client.js                                          //\n//                                                                               //\n///////////////////////////////////////////////////////////////////////////////////\n                                                                                 //\n////////////////////////// GET SERVER TIME DIFFERENCE ////////////////////////// // 1\n                                                                                 // 2\nServerTime = {};                                                                 // 3\n                                                                                 // 4\nServerTime._serverTimeDiff = 0; // Time difference in ms                         // 5\n                                                                                 // 6\nServerTime.now = function() {                                                    // 7\n  return Date.now() + ServerTime._serverTimeDiff;                                // 8\n};                                                                               // 9\n                                                                                 // 10\n// At server startup we figure out the time difference between server and        // 11\n// client time - this includes lag and timezone                                  // 12\n                                                                                 // 13\n// Use the ground store to handle storage for us                                 // 14\nvar _storage = Store.create({                                                    // 15\n  name: 'ServerTime',                                                            // 16\n  version: 1.0                                                                   // 17\n})                                                                               // 18\n                                                                                 // 19\n// Initialize the ServerTime._serverTimeDiff                                     // 20\n_storage.getItem('diff', function(err, time) {                                   // 21\n  if (err) {                                                                     // 22\n                                                                                 // 23\n  } else {                                                                       // 24\n                                                                                 // 25\n    // Set the time                                                              // 26\n    ServerTime._serverTimeDiff = time || 0;                                      // 27\n  }                                                                              // 28\n                                                                                 // 29\n});                                                                              // 30\n                                                                                 // 31\n// Call the server method an get server time                                     // 32\n// XXX: Use http call instead creating less overhead                             // 33\nMeteor.call('getServerTime', function(error, result) {                           // 34\n  if (!error) {                                                                  // 35\n    // Update our server time diff                                               // 36\n    ServerTime._serverTimeDiff = result - Date.now();// - lag or/and timezone    // 37\n    // Update the localstorage                                                   // 38\n    _storage.setItem('diff', ServerTime._serverTimeDiff, function(err, result) { // 39\n      // XXX:                                                                    // 40\n    });                                                                          // 41\n  }                                                                              // 42\n}); // EO Server call                                                            // 43\n///////////////////////////////////////////////////////////////////////////////////\n\n}).call(this);\n"]}